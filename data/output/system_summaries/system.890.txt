matching a trajectory with a network using a Hidden Markov Model and Viterbi algorithm