Codes for Learning Affinity via Spatial Propagation Networks