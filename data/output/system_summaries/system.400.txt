Spark algorithms for building k-nn graphs